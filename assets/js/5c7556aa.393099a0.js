"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[42080],{28453:(e,s,a)=>{a.d(s,{R:()=>i,x:()=>l});var n=a(96540);const c={},t=n.createContext(c);function i(e){const s=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:i(e.components),n.createElement(t.Provider,{value:s},e.children)}},33664:(e,s,a)=>{a.r(s),a.d(s,{assets:()=>r,contentTitle:()=>i,default:()=>h,frontMatter:()=>t,metadata:()=>l,toc:()=>o});var n=a(74848),c=a(28453);const t={title:"Callbacks with IBC v2",sidebar_label:"Callbacks with IBC v2",sidebar_position:7,slug:"/middleware/callbacks/callbacks-with-v2"},i="Use with IBC v2",l={id:"middleware/callbacks/callbacks-IBCv2",title:"Callbacks with IBC v2",description:"This page highlights some of the differences between IBC v2 and IBC classic relevant for the callbacks middleware and how to use the module with IBC v2. More details on middleware for IBC v2 can be found in the middleware section.",source:"@site/versioned_docs/version-v10.4.x/04-middleware/01-callbacks/07-callbacks-IBCv2.md",sourceDirName:"04-middleware/01-callbacks",slug:"/middleware/callbacks/callbacks-with-v2",permalink:"/v10/middleware/callbacks/callbacks-with-v2",draft:!1,unlisted:!1,tags:[],version:"v10.4.x",sidebarPosition:7,frontMatter:{title:"Callbacks with IBC v2",sidebar_label:"Callbacks with IBC v2",sidebar_position:7,slug:"/middleware/callbacks/callbacks-with-v2"},sidebar:"defaultSidebar",previous:{title:"Gas Management",permalink:"/v10/middleware/callbacks/gas"},next:{title:"Support transfer of coins whose base denom contains slashes",permalink:"/v10/migrations/support-denoms-with-slashes"}},r={},o=[{value:"Interfaces",id:"interfaces",level:2},{value:"Contract Developers",id:"contract-developers",level:2},{value:"Integration",id:"integration",level:2}];function d(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",ul:"ul",...(0,c.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{id:"use-with-ibc-v2",children:"Use with IBC v2"}),"\n",(0,n.jsxs)(s.p,{children:["This page highlights some of the differences between IBC v2 and IBC classic relevant for the callbacks middleware and how to use the module with IBC v2. More details on middleware for IBC v2 can be found in the ",(0,n.jsx)(s.a,{href:"/v10/ibc/middleware/developIBCv2",children:"middleware section"}),"."]}),"\n",(0,n.jsx)(s.h2,{id:"interfaces",children:"Interfaces"}),"\n",(0,n.jsx)(s.p,{children:"Some of the interface differences are:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["The callbacks middleware for IBC v2 requires the ",(0,n.jsx)(s.a,{href:"/v10/middleware/callbacks/overview",children:(0,n.jsx)(s.code,{children:"Underlying Application"})})," to implement the new ",(0,n.jsx)(s.a,{href:"https://github.com/cosmos/ibc-go/blob/main/modules/apps/callbacks/types/callbacks.go#L53-L58",children:(0,n.jsx)(s.code,{children:"CallbacksCompatibleModuleV2"})})," interface."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"channeltypesv2.Payload"})," is now used instead of ",(0,n.jsx)(s.code,{children:"channeltypes.Packet"})]}),"\n",(0,n.jsxs)(s.li,{children:["With IBC classic, the ",(0,n.jsx)(s.code,{children:"OnRecvPacket"})," callback returns the ",(0,n.jsx)(s.code,{children:"ack"}),", whereas v2 returns the ",(0,n.jsx)(s.code,{children:"recvResult"})," which is the ",(0,n.jsx)(s.a,{href:"https://github.com/cosmos/ibc-go/blob/main/modules/core/04-channel/v2/types/packet.pb.go#L26-L38",children:"status of the packet"}),": unspecified, success, failure or asynchronous"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"api.WriteAcknowledgementWrapper"})," is used instead of ",(0,n.jsx)(s.code,{children:"ICS4Wrapper.WriteAcknowledgement"}),". It is only needed if the lower level application is going to write an asynchronous acknowledgement."]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"contract-developers",children:"Contract Developers"}),"\n",(0,n.jsxs)(s.p,{children:["The wasmd contract keeper enables cosmwasm developers to use the callbacks middleware. The ",(0,n.jsx)(s.a,{href:"https://cosmwasm.cosmos.network/ibc/extensions/callbacks",children:"cosmwasm documentation"})," provides information for contract developers. The IBC v2 callbacks implementation uses a ",(0,n.jsx)(s.code,{children:"Payload"})," but reconstructs an IBC classic ",(0,n.jsx)(s.code,{children:"Packet"})," to preserve the cosmwasm contract keeper interface. Additionally contracts must now handle the IBC v2 ",(0,n.jsx)(s.code,{children:"ErrorAcknowledgement"})," sentinel value in the case of a failure."]}),"\n",(0,n.jsxs)(s.p,{children:["The callbacks middleware can be used for transfer + action workflows, for example a transfer and swap on receive. These workflows require knowledge of the ibc denom that has been received. To assist with parsing the ics20 packet, ",(0,n.jsx)(s.a,{href:"https://github.com/cosmos/solidity-ibc-eureka/blob/a8870b023e58622fb7b3f733572c684851f8e5ee/packages/cosmwasm/ibc-callbacks-helpers/src/ics20.rs#L7-L41",children:"helper functions"})," can be found in the solidity-ibc-eureka repository."]}),"\n",(0,n.jsx)(s.h2,{id:"integration",children:"Integration"}),"\n",(0,n.jsxs)(s.p,{children:["An example integration of the callbacks middleware in a transfer stack that is using IBC v2 can be found in the ",(0,n.jsx)(s.a,{href:"/v10/ibc/integration",children:"ibc-go integration section"})]})]})}function h(e={}){const{wrapper:s}={...(0,c.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}}}]);